{% extends "admin/base.html" %}

{% block page_title %}Assigner l'écran{% endblock %}

{% block main_content %}
<div class="mb-6">
    <a href="{{ url_for('admin.screens') }}" class="text-gray-500 hover:text-gray-700">
        <i class="fas fa-arrow-left mr-2"></i>Retour aux écrans
    </a>
</div>

<div class="max-w-2xl mx-auto">
    <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-6">
        <div class="flex items-center gap-4 mb-6">
            <div class="w-14 h-14 bg-purple-100 rounded-xl flex items-center justify-center">
                <i class="fas fa-tv text-purple-600 text-2xl"></i>
            </div>
            <div>
                <h2 class="text-xl font-bold text-gray-800">Assigner l'écran</h2>
                <p class="text-gray-500">Transférer l'écran vers un autre établissement</p>
            </div>
        </div>

        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
            <div class="flex items-start gap-3">
                <i class="fas fa-info-circle text-blue-500 mt-0.5"></i>
                <div class="text-sm text-blue-700">
                    <p class="font-medium mb-1">Écran sélectionné</p>
                    <ul class="space-y-1">
                        <li><strong>Nom:</strong> {{ screen.name }}</li>
                        <li><strong>Emplacement:</strong> {{ screen.location or 'Non défini' }}</li>
                        <li><strong>Résolution:</strong> {{ screen.resolution_width }}x{{ screen.resolution_height }}</li>
                        <li><strong>Établissement actuel:</strong> {{ screen.organization.name if screen.organization else 'Aucun' }}</li>
                    </ul>
                </div>
            </div>
        </div>

        <form method="POST" class="space-y-6">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            <div>
                <label class="label">Nouvel établissement</label>
                <select name="organization_id" class="input-field" required>
                    <option value="">Sélectionner un établissement...</option>
                    {% for org in organizations %}
                    <option value="{{ org.id }}" {% if screen.organization_id == org.id %}selected{% endif %}>
                        {{ org.name }}
                        {% if screen.organization_id == org.id %}(actuel){% endif %}
                    </option>
                    {% endfor %}
                </select>
                <p class="text-xs text-gray-500 mt-1">L'écran sera transféré vers cet établissement</p>
            </div>

            <div class="bg-amber-50 border border-amber-200 rounded-lg p-4">
                <div class="flex items-start gap-3">
                    <i class="fas fa-exclamation-triangle text-amber-500 mt-0.5"></i>
                    <div class="text-sm text-amber-700">
                        <p class="font-medium mb-1">Attention</p>
                        <ul class="list-disc list-inside space-y-1">
                            <li>Les réservations existantes restent liées à l'écran</li>
                            <li>L'ancien établissement n'aura plus accès à cet écran</li>
                            <li>Les tarifs et créneaux horaires sont conservés</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="flex gap-3">
                <button type="submit" class="btn-primary">
                    <i class="fas fa-exchange-alt"></i>
                    Transférer l'écran
                </button>
                <a href="{{ url_for('admin.screens') }}" class="btn-secondary">
                    Annuler
                </a>
            </div>
        </form>
    </div>
</div>
{% endblock %}
